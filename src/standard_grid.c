/*
 * Copyright (c) Microsoft Corporation.
 * Licensed under the MIT License.
 */
#include "standard_grid.h"

/*
 * Standard grid SG-2
 * Ref: Standard Grids for High-Precision Integration of Modern Density Functionals: SG-2 and SG-3
 */

u64 STANDARD_GRID_SG2[119][10] = {
    {75, 302}, /* Placeholder */
    {35, 6, 12, 110, 16, 302, 7, 86, 5, 26}, /* H */
    {75, 302}, /* He */
    {35, 6, 12, 110, 17, 302, 7, 86, 4, 50}, /* Li */
    {35, 6, 12, 110, 17, 302, 7, 86, 4, 50}, /* Be */
    {35, 6, 12, 110, 17, 302, 7, 146, 4, 26}, /* B */
    {35, 6, 12, 110, 17, 302, 7, 146, 4, 26}, /* C */
    {35, 6, 12, 110, 17, 302, 7, 86, 4, 26}, /* N */
    {30, 6, 14, 110, 18, 302, 8, 146, 5, 50}, /* O */
    {26, 6, 16, 110, 19, 302, 8, 110, 6, 50}, /* F */
    {75, 302}, /* Ne */
    {35, 6, 12, 110, 17, 302, 7, 86, 4, 50}, /* Na */
    {35, 6, 12, 110, 17, 302, 7, 86, 4, 50}, /* Mg */
    {32, 6, 15, 110, 17, 302, 7, 146, 4, 86}, /* Al */
    {32, 6, 15, 110, 17, 302, 7, 146, 4, 50}, /* Si */
    {30, 6, 14, 110, 17, 302, 7, 146, 7, 38}, /* P */
    {30, 6, 14, 110, 17, 302, 7, 146, 7, 38}, /* S */
    {26, 6, 16, 110, 19, 302, 8, 110, 6, 50}, /* Cl */
    {75, 302}, /* Ar */
    {75, 302}, /* K */
    {75, 302}, /* Ca */
    {75, 302}, /* Sc */
    {75, 302}, /* Ti */
    {75, 302}, /* V */
    {75, 302}, /* Cr */
    {75, 302}, /* Mn */
    {75, 302}, /* Fe */
    {75, 302}, /* Co */
    {75, 302}, /* Ni */
    {75, 302}, /* Cu */
    {75, 302}, /* Zn */
    {75, 302}, /* Ga */
    {75, 302}, /* Ge */
    {75, 302}, /* As */
    {75, 302}, /* Se */
    {75, 302}, /* Br */
    {75, 302}, /* Kr */
    {75, 302}, /* Rb */
    {75, 302}, /* Sr */
    {75, 302}, /* Y */
    {75, 302}, /* Zr */
    {75, 302}, /* Nb */
    {75, 302}, /* Mo */
    {75, 302}, /* Tc */
    {75, 302}, /* Ru */
    {75, 302}, /* Rh */
    {75, 302}, /* Pd */
    {75, 302}, /* Ag */
    {75, 302}, /* Cd */
    {75, 302}, /* In */
    {75, 302}, /* Sn */
    {75, 302}, /* Sb */
    {75, 302}, /* Te */
    {75, 302}, /* I */
    {75, 302}, /* Xe */
    {75, 302}, /* Cs */
    {75, 302}, /* Ba */
    {75, 302}, /* La */
    {75, 302}, /* Ce */
    {75, 302}, /* Pr */
    {75, 302}, /* Nd */
    {75, 302}, /* Pm */
    {75, 302}, /* Sm */
    {75, 302}, /* Eu */
    {75, 302}, /* Gd */
    {75, 302}, /* Tb */
    {75, 302}, /* Dy */
    {75, 302}, /* Ho */
    {75, 302}, /* Er */
    {75, 302}, /* Tm */
    {75, 302}, /* Yb */
    {75, 302}, /* Lu */
    {75, 302}, /* Hf */
    {75, 302}, /* Ta */
    {75, 302}, /* W */
    {75, 302}, /* Re */
    {75, 302}, /* Os */
    {75, 302}, /* Ir */
    {75, 302}, /* Pt */
    {75, 302}, /* Au */
    {75, 302}, /* Hg */
    {75, 302}, /* Tl */
    {75, 302}, /* Pb */
    {75, 302}, /* Bi */
    {75, 302}, /* Po */
    {75, 302}, /* At */
    {75, 302}, /* Rn */
    {75, 302}, /* Fr */
    {75, 302}, /* Ra */
    {75, 302}, /* Ac */
    {75, 302}, /* Th */
    {75, 302}, /* Pa */
    {75, 302}, /* U */
    {75, 302}, /* Np */
    {75, 302}, /* Pu */
    {75, 302}, /* Am */
    {75, 302}, /* Cm */
    {75, 302}, /* Bk */
    {75, 302}, /* Cf */
    {75, 302}, /* Es */
    {75, 302}, /* Fm */
    {75, 302}, /* Md */
    {75, 302}, /* No */
    {75, 302}, /* Lr */
    {75, 302}, /* Rf */
    {75, 302}, /* Db */
    {75, 302}, /* Sg */
    {75, 302}, /* Bh */
    {75, 302}, /* Hs */
    {75, 302}, /* Mt */
    {75, 302},  /* Ds */
    {75, 302},  /* Rg */
    {75, 302},  /* Cn */
    {75, 302},  /* Nh */
    {75, 302},  /* Fl */
    {75, 302},  /* Mc */
    {75, 302},  /* Lv */
    {75, 302},  /* Ts */
    {75, 302}   /* Og: 118 (Z) */
};

u64 STANDARD_GRID_SG3[119][18] = {
    {99, 590}, /* Placeholder */
    {45, 6, 16, 110, 21, 590, 10, 194, 7, 50}, /* H */
    {99, 590}, /* He */
    {46, 6, 16, 110, 22, 590, 9, 146, 6, 50}, /* Li */
    {42, 6, 6, 86, 14, 110, 22, 590, 3, 194, 6, 146, 6, 50}, /* Be */
    {42, 6, 6, 86, 14, 110, 22, 590, 9, 194, 6, 50}, /* B */
    {46, 6, 16, 146, 22, 590, 1, 302, 2, 194, 6, 146, 6, 86}, /* C */
    {40, 6, 18, 110, 24, 590, 11, 146, 6, 50}, /* N */
    {40, 6, 14, 110, 2, 194, 2, 302, 24, 590, 1, 302, 1, 194, 8, 146, 7, 50}, /* O */
    {35, 6, 17, 110, 4, 194, 25, 590, 2, 194, 8, 110, 8, 50}, /* F */
    {99, 590}, /* Ne */
    {46, 6, 16, 110, 22, 590, 9, 146, 6, 50}, /* Na */
    {48, 6, 15, 110, 20, 590, 7, 146, 9, 50}, /* Mg */
    {42, 6, 6, 86, 14, 110, 22, 590, 3, 194, 6, 146, 6, 50}, /* Al */
    {42, 6, 6, 86, 14, 110, 22, 590, 9, 194, 6, 50}, /* Si */
    {35, 6, 1, 86, 18, 110, 4, 194, 25, 590, 2, 194, 8, 146, 6, 50}, /* P */
    {35, 6, 1, 86, 18, 110, 4, 194, 25, 590, 2, 194, 8, 146, 6, 50}, /* S */
    {35, 6, 17, 110, 4, 194, 25, 590, 2, 194, 8, 110, 8, 50}, /* Cl */
    {99, 590}, /* Ar */
    {99, 590}, /* K */
    {99, 590}, /* Ca */
    {99, 590}, /* Sc */
    {99, 590}, /* Ti */
    {99, 590}, /* V */
    {99, 590}, /* Cr */
    {99, 590}, /* Mn */
    {99, 590}, /* Fe */
    {99, 590}, /* Co */
    {99, 590}, /* Ni */
    {99, 590}, /* Cu */
    {99, 590}, /* Zn */
    {99, 590}, /* Ga */
    {99, 590}, /* Ge */
    {99, 590}, /* As */
    {99, 590}, /* Se */
    {99, 590}, /* Br */
    {99, 590}, /* Kr */
    {99, 590}, /* Rb */
    {99, 590}, /* Sr */
    {99, 590}, /* Y */
    {99, 590}, /* Zr */
    {99, 590}, /* Nb */
    {99, 590}, /* Mo */
    {99, 590}, /* Tc */
    {99, 590}, /* Ru */
    {99, 590}, /* Rh */
    {99, 590}, /* Pd */
    {99, 590}, /* Ag */
    {99, 590}, /* Cd */
    {99, 590}, /* In */
    {99, 590}, /* Sn */
    {99, 590}, /* Sb */
    {99, 590}, /* Te */
    {99, 590}, /* I */
    {99, 590}, /* Xe */
    {99, 590}, /* Cs */
    {99, 590}, /* Ba */
    {99, 590}, /* La */
    {99, 590}, /* Ce */
    {99, 590}, /* Pr */
    {99, 590}, /* Nd */
    {99, 590}, /* Pm */
    {99, 590}, /* Sm */
    {99, 590}, /* Eu */
    {99, 590}, /* Gd */
    {99, 590}, /* Tb */
    {99, 590}, /* Dy */
    {99, 590}, /* Ho */
    {99, 590}, /* Er */
    {99, 590}, /* Tm */
    {99, 590}, /* Yb */
    {99, 590}, /* Lu */
    {99, 590}, /* Hf */
    {99, 590}, /* Ta */
    {99, 590}, /* W */
    {99, 590}, /* Re */
    {99, 590}, /* Os */
    {99, 590}, /* Ir */
    {99, 590}, /* Pt */
    {99, 590}, /* Au */
    {99, 590}, /* Hg */
    {99, 590}, /* Tl */
    {99, 590}, /* Pb */
    {99, 590}, /* Bi */
    {99, 590}, /* Po */
    {99, 590}, /* At */
    {99, 590}, /* Rn */
    {99, 590}, /* Fr */
    {99, 590}, /* Ra */
    {99, 590}, /* Ac */
    {99, 590}, /* Th */
    {99, 590}, /* Pa */
    {99, 590}, /* U */
    {99, 590}, /* Np */
    {99, 590}, /* Pu */
    {99, 590}, /* Am */
    {99, 590}, /* Cm */
    {99, 590}, /* Bk */
    {99, 590}, /* Cf */
    {99, 590}, /* Es */
    {99, 590}, /* Fm */
    {99, 590}, /* Md */
    {99, 590}, /* No */
    {99, 590}, /* Lr */
    {99, 590}, /* Rf */
    {99, 590}, /* Db */
    {99, 590}, /* Sg */
    {99, 590}, /* Bh */
    {99, 590}, /* Hs */
    {99, 590}, /* Mt */
    {99, 590},  /* Ds */
    {99, 590},  /* Rg */
    {99, 590},  /* Cn */
    {99, 590},  /* Nh */
    {99, 590},  /* Fl */
    {99, 590},  /* Mc */
    {99, 590},  /* Lv */
    {99, 590},  /* Ts */
    {99, 590}   /* Og: 118 (Z) */
};

u64 get_standard_grid_point_num(u64 z, u64 grid_scheme)
{
    u64 n_points = 0;

    if (grid_scheme == GRID_SCHEME_SG2)
    {
        for (u64 i = 0; i < 5; ++i)
        {
            n_points += STANDARD_GRID_SG2[z][i * 2] * STANDARD_GRID_SG2[z][i * 2 + 1];
        }
    }

    if (grid_scheme == GRID_SCHEME_SG3)
    {
        for (u64 i = 0; i < 9; ++i)
        {
            n_points += STANDARD_GRID_SG3[z][i * 2] * STANDARD_GRID_SG3[z][i * 2 + 1];
        }
    }

    return n_points;
}

u64 get_standard_grid_radial_point_num(u64 z, u64 grid_scheme)
{
    u64 n_points = 0;

    if (grid_scheme == GRID_SCHEME_SG2)
    {
        for (u64 i = 0; i < 5; ++i)
        {
            n_points += STANDARD_GRID_SG2[z][i * 2];
        }
    }

    if (grid_scheme == GRID_SCHEME_SG3)
    {
        for (u64 i = 0; i < 9; ++i)
        {
            n_points += STANDARD_GRID_SG3[z][i * 2];
        }
    }

    return n_points;
}

u64 get_standard_grid_angular_point_num_by_radial_point_idx(u64 z, u64 grid_scheme, u64 radial_point_idx)
{
    u64 radial_point_count = 0;

    if (grid_scheme == GRID_SCHEME_SG2)
    {
        for (u64 i = 0; i < 5; ++i)
        {
            radial_point_count += STANDARD_GRID_SG2[z][i * 2];

            if (radial_point_idx < radial_point_count)
            {
                return STANDARD_GRID_SG2[z][i * 2 + 1];
            }
        }
    }

    if (grid_scheme == GRID_SCHEME_SG3)
    {
        for (u64 i = 0; i < 9; ++i)
        {
            radial_point_count += STANDARD_GRID_SG3[z][i * 2];

            if (radial_point_idx < radial_point_count)
            {
                return STANDARD_GRID_SG3[z][i * 2 + 1];
            }
        }
    }

    return 0;
}

#ifdef MODULE_TEST
#include <stdio.h>
int main(void)
{
    for (u64 i = 0; i < 119; i++)
    {
        printf("%lu: %lu %lu\n", i, get_standard_grid_radial_point_num(i, GRID_SCHEME_SG2), get_standard_grid_point_num(i, GRID_SCHEME_SG2));
    }

    u64 count = 0;

    for (u64 i = 0; i < 99; ++i)
    {
        ++count;
        printf("%lu/%lu: %lu\n", i, count, get_standard_grid_angular_point_num_by_radial_point_idx(1, GRID_SCHEME_SG3, i));
    }
    return 0;
}
#endif
